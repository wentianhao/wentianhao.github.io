<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="å…ˆé€ƒè·‘å†è¯´"><meta name="copyright" content="å…ˆé€ƒè·‘å†è¯´"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>SpringBoot-è¡¨å•éªŒè¯-ç»Ÿä¸€å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº | wanheo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><script src="//at.alicdn.com/t/font_1140697_stqaphw3j4.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"wentianhao.github.io","root":"/","title":"å…ˆé€ƒè·‘å†è¯´","version":"1.6.1","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æƒ³è¦æœäº›ä»€ä¹ˆï¼Ÿ","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="wanheo" type="application/atom+xml"><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="å‰ç«¯éªŒè¯ä¸€èˆ¬æ˜¯ä¸ºäº†æ»¡è¶³ç•Œé¢çš„å‹å¥½æ€§ã€å®¢æˆ·ä½“éªŒæ€§ç­‰ï¼Œä½†ä»…é å‰ç«¯è¿›è¡Œæ•°æ®åˆæ³•æ€§æ ¡éªŒï¼Œæ˜¯ä¸å¤Ÿçš„ã€‚å› ä¸ºéæ³•ç”¨æˆ·å¯èƒ½ä¼šç›´æ¥ä»å®¢æˆ·ç«¯è·å–è¯·æ±‚åœ°å€è¿›è¡Œéæ³•è¯·æ±‚ï¼Œæ‰€ä»¥åç«¯çš„æ ¡éªŒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚ åœ¨ä¹¦å†™ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œç»å¸¸æœ‰å¤§é‡çš„åˆ¤ç©ºæ ¡éªŒã€‚æ¯”å¦‚Serviceå±‚æˆ–Daoå±‚çš„æ–¹æ³•å…¥å‚ã€å…¥å‚å¯¹è±¡ã€å‡ºå‚ç­‰éƒ½æœ‰ä¸€å¥—æ ¡éªŒè§„åˆ™ã€‚æ¯”å¦‚æœ‰çš„å­—æ®µå¿…ä¼ ï¼Œæœ‰çš„éå¿…ä¼ ï¼Œè¿”å›å€¼æœ‰äº›å­—æ®µå¿…é¡»æœ‰å€¼ï¼Œæœ‰çš„éå¿…é¡»ç­‰ç­‰ ä¼—å¤šif elseçš„é‡å¤æ— æ„ä¹‰ä»£ç ï¼Œä¹Ÿ">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot-è¡¨å•éªŒè¯-ç»Ÿä¸€å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº">
<meta property="og:url" content="https://wentianhao.github.io/2021/08/20/validation/index.html">
<meta property="og:site_name" content="wanheo">
<meta property="og:description" content="å‰ç«¯éªŒè¯ä¸€èˆ¬æ˜¯ä¸ºäº†æ»¡è¶³ç•Œé¢çš„å‹å¥½æ€§ã€å®¢æˆ·ä½“éªŒæ€§ç­‰ï¼Œä½†ä»…é å‰ç«¯è¿›è¡Œæ•°æ®åˆæ³•æ€§æ ¡éªŒï¼Œæ˜¯ä¸å¤Ÿçš„ã€‚å› ä¸ºéæ³•ç”¨æˆ·å¯èƒ½ä¼šç›´æ¥ä»å®¢æˆ·ç«¯è·å–è¯·æ±‚åœ°å€è¿›è¡Œéæ³•è¯·æ±‚ï¼Œæ‰€ä»¥åç«¯çš„æ ¡éªŒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚ åœ¨ä¹¦å†™ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œç»å¸¸æœ‰å¤§é‡çš„åˆ¤ç©ºæ ¡éªŒã€‚æ¯”å¦‚Serviceå±‚æˆ–Daoå±‚çš„æ–¹æ³•å…¥å‚ã€å…¥å‚å¯¹è±¡ã€å‡ºå‚ç­‰éƒ½æœ‰ä¸€å¥—æ ¡éªŒè§„åˆ™ã€‚æ¯”å¦‚æœ‰çš„å­—æ®µå¿…ä¼ ï¼Œæœ‰çš„éå¿…ä¼ ï¼Œè¿”å›å€¼æœ‰äº›å­—æ®µå¿…é¡»æœ‰å€¼ï¼Œæœ‰çš„éå¿…é¡»ç­‰ç­‰ ä¼—å¤šif elseçš„é‡å¤æ— æ„ä¹‰ä»£ç ï¼Œä¹Ÿ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://whh.plus/images/valid1.png">
<meta property="og:image" content="https://whh.plus/images/test1.png">
<meta property="og:image" content="https://whh.plus/images/get.png">
<meta property="og:image" content="https://whh.plus/images/add.png">
<meta property="og:image" content="https://whh.plus/images/add1.png">
<meta property="og:image" content="https://whh.plus/images/put.png">
<meta property="og:image" content="https://whh.plus/images/delete.png">
<meta property="og:image" content="https://whh.plus/images/phone.png">
<meta property="og:image" content="https://whh.plus/images/get1.png">
<meta property="og:image" content="https://whh.plus/images/testException.png">
<meta property="article:published_time" content="2021-08-20T13:29:16.000Z">
<meta property="article:modified_time" content="2021-08-22T07:09:09.399Z">
<meta property="article:author" content="å…ˆé€ƒè·‘å†è¯´">
<meta property="article:tag" content="spring boot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://whh.plus/images/valid1.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><canvas id="trianglifyContainer"></canvas><script defer src="https://cdn.jsdelivr.net/npm/trianglify@4/dist/trianglify.bundle.js"></script><script>document.addEventListener("DOMContentLoaded", () => {
  const pattern = trianglify({
    width: 800,
    height: 600,
    cellSize: 75,
    palette: ["YlGnBu", "GnBu", "Purples", "Blues"],
  });
  const canvasOpts = {
    applyCssScaling: false
  }
  document.body.appendChild(pattern.toCanvas(trianglifyContainer, canvasOpts));
});</script><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="å…ˆé€ƒè·‘å†è¯´"><img width="96" loading="lazy" src="/images/wen.jpg" alt="å…ˆé€ƒè·‘å†è¯´"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ˜Š</span></a><div class="site-author-name"><a href="/about/">å…ˆé€ƒè·‘å†è¯´</a></div><a class="site-name" href="/about/site.html">wanheo</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="æˆ‘çš„ä¸»é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">86</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">27</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">35</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/wentianhao" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=286380463" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="1024008684@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">é¡¹ç›®ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">1.1.</span> <span class="toc-text">å¯¼å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">æ·»åŠ å®ä½“ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E5%B0%81%E8%A3%85%E7%B1%BB"><span class="toc-number">1.3.</span> <span class="toc-text">æ¥å£è¿”å›å°è£…ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">1.4.</span> <span class="toc-text">æ§åˆ¶å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">1.5.</span> <span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%A0%A1%E9%AA%8C"><span class="toc-number">2.</span> <span class="toc-text">åˆ†ç»„æ ¡éªŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%86%E7%BB%84%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.1.</span> <span class="toc-text">æ·»åŠ åˆ†ç»„æ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">2.2.</span> <span class="toc-text">ä¿®æ”¹å®ä½“ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">2.3.</span> <span class="toc-text">ä¿®æ”¹æ§åˆ¶å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-number">2.4.</span> <span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%AA%8C%E8%AF%81"><span class="toc-number">3.</span> <span class="toc-text">è‡ªå®šä¹‰éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.1.</span> <span class="toc-text">æ·»åŠ æ³¨è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%AA%8C%E8%AF%81%E9%80%BB%E8%BE%91"><span class="toc-number">3.2.</span> <span class="toc-text">ç¼–å†™éªŒè¯é€»è¾‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BD%93"><span class="toc-number">3.3.</span> <span class="toc-text">ä¿®æ”¹å®ä½“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-2"><span class="toc-number">3.4.</span> <span class="toc-text">æµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pattern"><span class="toc-number">3.5.</span> <span class="toc-text">@Pattern</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E9%AA%8C%E8%AF%81"><span class="toc-number">4.</span> <span class="toc-text">è°ƒç”¨è¿‡ç¨‹éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-spring-bean"><span class="toc-number">4.1.</span> <span class="toc-text">ä½¿ç”¨ spring bean</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%8F%82%E6%95%B0%E9%AA%8C%E8%AF%81"><span class="toc-number">5.</span> <span class="toc-text">æ–¹æ³•å‚æ•°éªŒè¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">ç»Ÿä¸€å¼‚å¸¸å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%B1%BB"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ›å»ºä¸šåŠ¡å¼‚å¸¸ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">6.2.</span> <span class="toc-text">åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%8E%A7%E5%88%B6%E5%99%A8-1"><span class="toc-number">6.3.</span> <span class="toc-text">ä¿®æ”¹æ§åˆ¶å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-3"><span class="toc-number">6.4.</span> <span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%AA%8C%E8%AF%81%E4%BF%A1%E6%81%AF%E6%BA%90"><span class="toc-number">7.</span> <span class="toc-text">è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-ValidatorConfig"><span class="toc-number">7.1.</span> <span class="toc-text">ä¿®æ”¹é…ç½®æ–‡ä»¶(ValidatorConfig)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BF%A1%E6%81%AF%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text">æ·»åŠ ä¿¡æ¯æºæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BD%93%E7%B1%BB-1"><span class="toc-number">7.3.</span> <span class="toc-text">ä¿®æ”¹å®ä½“ç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">8.</span> <span class="toc-text">æ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">9.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://wentianhao.github.io/2021/08/20/validation/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="å…ˆé€ƒè·‘å†è¯´"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="wanheo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">SpringBoot-è¡¨å•éªŒè¯-ç»Ÿä¸€å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº<a class="post-edit-link" href="https://github.com/wentianhao/wentianhao.github.io/tree/hexo/source/_posts/validation.md" target="_blank" title="ç¼–è¾‘" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-08-20 21:29:16" itemprop="dateCreated datePublished" datetime="2021-08-20T21:29:16+08:00">2021-08-20</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-22 15:09:09" itemprop="dateModified" datetime="2021-08-22T15:09:09+08:00">2021-08-22</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">4.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">21m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/spring-boot/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">spring boot</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/spring-boot/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">spring boot</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p>å‰ç«¯éªŒè¯ä¸€èˆ¬æ˜¯ä¸ºäº†æ»¡è¶³ç•Œé¢çš„å‹å¥½æ€§ã€å®¢æˆ·ä½“éªŒæ€§ç­‰ï¼Œä½†ä»…é å‰ç«¯è¿›è¡Œæ•°æ®åˆæ³•æ€§æ ¡éªŒï¼Œæ˜¯ä¸å¤Ÿçš„ã€‚å› ä¸ºéæ³•ç”¨æˆ·å¯èƒ½ä¼šç›´æ¥ä»å®¢æˆ·ç«¯è·å–è¯·æ±‚åœ°å€è¿›è¡Œéæ³•è¯·æ±‚ï¼Œæ‰€ä»¥åç«¯çš„æ ¡éªŒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p>
<p>åœ¨ä¹¦å†™ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œç»å¸¸æœ‰å¤§é‡çš„åˆ¤ç©ºæ ¡éªŒã€‚æ¯”å¦‚Serviceå±‚æˆ–Daoå±‚çš„æ–¹æ³•å…¥å‚ã€å…¥å‚å¯¹è±¡ã€å‡ºå‚ç­‰éƒ½æœ‰ä¸€å¥—æ ¡éªŒè§„åˆ™ã€‚æ¯”å¦‚æœ‰çš„å­—æ®µå¿…ä¼ ï¼Œæœ‰çš„éå¿…ä¼ ï¼Œè¿”å›å€¼æœ‰äº›å­—æ®µå¿…é¡»æœ‰å€¼ï¼Œæœ‰çš„éå¿…é¡»ç­‰ç­‰</p>
<p>ä¼—å¤šif elseçš„é‡å¤æ— æ„ä¹‰ä»£ç ï¼Œä¹Ÿå¯ç§°ä¸ºåƒåœ¾ä»£ç ã€‚Bean Validationæ ¡éªŒæ˜¯åŸºäºDDDæ€æƒ³è®¾è®¡çš„ã€‚</p>
<h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><p><img src="https://whh.plus/images/valid1.png" alt="é¡¹ç›®ç»“æ„å›¾" loading="lazy"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">â”œâ”€â”€ java
â”‚   â””â”€â”€ com
â”‚       â””â”€â”€ whh
â”‚           â””â”€â”€ valid
â”‚               â”œâ”€â”€ ValidApplication.java <span class="token comment"># å¯åŠ¨ç±»</span>
â”‚               â”œâ”€â”€ annotation
â”‚               â”‚   â””â”€â”€ Phone.java <span class="token comment"># è‡ªå®šä¹‰éªŒè¯æ³¨è§£</span>
â”‚               â”œâ”€â”€ config
â”‚               â”‚   â””â”€â”€ ValidatorConfig.java <span class="token comment"># è¡¨å•éªŒè¯é…ç½®ç±»</span>
â”‚               â”œâ”€â”€ controller
â”‚               â”‚   â””â”€â”€ SysUserController.java <span class="token comment"># ç”¨æˆ·ç®¡ç†æ§åˆ¶å™¨</span>
â”‚               â”œâ”€â”€ exception
â”‚               â”‚   â”œâ”€â”€ BusinessException.java <span class="token comment"># ä¸šåŠ¡å¼‚å¸¸ç±»</span>
â”‚               â”‚   â””â”€â”€ GlobalExceptionHandler.java <span class="token comment"># ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»</span>
â”‚               â”œâ”€â”€ entity
â”‚               â”‚   â”œâ”€â”€ SysUser.java <span class="token comment"># ç”¨æˆ·ä¿¡æ¯å®ä½“</span>
â”‚               â”‚   â””â”€â”€ ValidationInterface.java <span class="token comment"># è¡¨å•éªŒè¯çš„é€šç”¨åˆ†ç»„æ¥å£</span>
â”‚               â”œâ”€â”€ util
â”‚               â”‚   â””â”€â”€ CommonResult.java <span class="token comment"># æ¥å£è¿”å›å°è£…ç±»</span>
â”‚               â””â”€â”€ validation
â”‚                   â””â”€â”€ PhoneValidator.java <span class="token comment">#è‡ªå®šä¹‰éªŒè¯å®ç°ç±»</span>
â””â”€â”€ resources
    â”œâ”€â”€ application.yaml <span class="token comment"># é…ç½®æ–‡ä»¶</span>
    â””â”€â”€ messages
        â””â”€â”€ validation
            â””â”€â”€ messages.properties <span class="token comment"># è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº</span></code></pre>
<h3 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h3><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.whh<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>valid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>valid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>è¡¨å•éªŒè¯demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- webæ”¯æŒ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- è¡¨å•éªŒè¯ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.1.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>hibernate-validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.3.5.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excludes</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludes</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span></code></pre>

<h3 id="æ·»åŠ å®ä½“ç±»"><a href="#æ·»åŠ å®ä½“ç±»" class="headerlink" title="æ·»åŠ å®ä½“ç±»"></a>æ·»åŠ å®ä½“ç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Email</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">NotEmpty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Size</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUser</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token comment">// ä¸»é”®</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">//ç”¨æˆ·å</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token comment">// å¯†ç </span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">"å¯†ç é•¿åº¦å¿…é¡»åœ¨&#123;min&#125; - &#123;max&#125;ä¹‹é—´"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>

    <span class="token comment">// é‚®ç®±åœ°å€</span>
    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±åœ°å€ä¸åˆæ³•"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token comment">// ç”µè¯</span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸åˆæ³•"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>@Dataæ³¨è§£ï¼šæé«˜ä»£ç çš„ç®€æ´ï¼Œä½¿ç”¨è¿™ä¸ªæ³¨è§£å¯ä»¥çœå»ä»£ç ä¸­å¤§é‡çš„get()ã€ set()ã€ toString()ç­‰æ–¹æ³•ï¼›</p>
<h3 id="æ¥å£è¿”å›å°è£…ç±»"><a href="#æ¥å£è¿”å›å°è£…ç±»" class="headerlink" title="æ¥å£è¿”å›å°è£…ç±»"></a>æ¥å£è¿”å›å°è£…ç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>


<span class="token comment">// æ“ä½œæ¶ˆæ¯æé†’</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// çŠ¶æ€ç </span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>

    <span class="token comment">// è¿”å›å†…å®¹</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token comment">// æ•°æ®å¯¹è±¡</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> data<span class="token punctuation">;</span>

    <span class="token comment">// åˆå§‹åŒ–ä¸€ä¸ªCommonResultå¯¹è±¡</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Type</span> type<span class="token punctuation">,</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> type<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Type</span> type<span class="token punctuation">,</span><span class="token class-name">String</span> msg<span class="token punctuation">,</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> type<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// è¿”å›æˆåŠŸæ¶ˆæ¯</span>
    <span class="token keyword">public</span>  <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span>  <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">,</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">.</span>SUCCESS<span class="token punctuation">,</span>msg<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// è¿”å›è­¦å‘Šæ¶ˆæ¯</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">warn</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">warn</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">,</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">.</span>WARN<span class="token punctuation">,</span>msg<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// è¿”å›é”™è¯¯æ¶ˆæ¯</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æ“ä½œå¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">,</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span>msg<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Type</span><span class="token punctuation">&#123;</span>
        <span class="token comment">// æˆåŠŸ</span>
        <span class="token function">SUCCESS</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// è­¦å‘Š</span>
        <span class="token function">WARN</span><span class="token punctuation">(</span><span class="token number">301</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// é”™è¯¯</span>
        <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>

        <span class="token class-name">Type</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>@NoArgsConstructoræ³¨è§£ï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼Œä¸ºç±»æä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ã€‚</p>
<h3 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty<span class="token punctuation">.</span></span><span class="token class-name">SysUser</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindingResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">FieldError</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Validated</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"sys/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUserController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">></span></span> USERS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ•°æ®åˆå§‹åŒ–</span>
    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SysUser</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"wen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"13666666666"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"example@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SysUser</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"13688888888"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"example1@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// æ–°å¢ç”¨æˆ·</span>
    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SysUser</span> sysUser<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">String</span> field <span class="token operator">=</span> fieldError<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> rejectedValue <span class="token operator">=</span> fieldError<span class="token punctuation">.</span><span class="token function">getRejectedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">"["</span> <span class="token operator">+</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125;: å­—æ®µ==&#123;&#125;\tå€¼=&#123;&#125;"</span><span class="token punctuation">,</span>msg<span class="token punctuation">,</span>field<span class="token punctuation">,</span>rejectedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sysUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ–°å¢æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<ul>
<li>@Validatedæ³¨è§£ï¼šæ ‡è¯†éœ€è¦éªŒè¯çš„ç±»ï¼Œä½¿ç”¨BindingResultç±»æ¥å—é”™è¯¯ä¿¡æ¯</li>
<li>@Slf4jæ³¨è§£ï¼šç”¨ä½œæ—¥å¿—è¾“å‡ºçš„ï¼Œä¸€èˆ¬ä¼šåœ¨é¡¹ç›®æ¯ä¸ªç±»çš„å¼€å¤´åŠ å…¥è¯¥æ³¨è§£ï¼Œå¦‚æœä¸å†™ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¹¶ä¸”æƒ³ç”¨log<br><code>private final Logger logger = LoggerFactory.getLogger(å½“å‰ç±»å.class);</code></li>
</ul>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><img src="https://whh.plus/images/test1.png" alt="æµ‹è¯•" loading="lazy"><br>log<br><code>[é‚®ç®±åœ°å€ä¸åˆæ³•]: å­—æ®µ==email    å€¼=123</code></p>
<h2 id="åˆ†ç»„æ ¡éªŒ"><a href="#åˆ†ç»„æ ¡éªŒ" class="headerlink" title="åˆ†ç»„æ ¡éªŒ"></a>åˆ†ç»„æ ¡éªŒ</h2><p>groupsè¡¨ç¤ºæ³¨è§£å±äºå“ªä¸ªç»„ï¼Œä¾¿æŒ‰ç…§å“ªä¸ªç»„çš„æ ¡éªŒè§„åˆ™è¿›è¡Œæ ¡éªŒ</p>
<p>å½“åœ¨controllerä¸­æ ¡éªŒè¡¨å•æ•°æ®æ—¶ï¼Œå¦‚æœä½¿ç”¨äº†groupsï¼Œé‚£ä¹ˆæ²¡æœ‰åœ¨è¿™ä¸ªåˆ†ç»„ä¸‹çš„å±æ€§æ˜¯ä¸ä¼šæ ¡éªŒçš„</p>
<h3 id="æ·»åŠ åˆ†ç»„æ¥å£"><a href="#æ·»åŠ åˆ†ç»„æ¥å£" class="headerlink" title="æ·»åŠ åˆ†ç»„æ¥å£"></a>æ·»åŠ åˆ†ç»„æ¥å£</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty</span><span class="token punctuation">;</span>

<span class="token comment">// ç”¨äºè¡¨å•éªŒè¯çš„é€šç”¨åˆ†ç»„æ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ValidationInterface</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**
     *æ–°å¢åˆ†ç»„
     */</span>
    <span class="token keyword">interface</span> add<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

     <span class="token comment">/**
      * åˆ é™¤åˆ†ç»„
      */</span>
    <span class="token keyword">interface</span> delete<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     *æŸ¥è¯¢åˆ†ç»„
     */</span>
    <span class="token keyword">interface</span> select<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ›´æ–°åˆ†ç»„
     */</span>
    <span class="token keyword">interface</span> update<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>å¦‚æœè¿˜æœ‰å…¶å®ƒç‰¹æ®Šçš„åˆ†ç»„è¦æ±‚ ç›´æ¥åœ¨DOä¸­åˆ›å»ºinterfaceå³å¯</p>
<h3 id="ä¿®æ”¹å®ä½“ç±»"><a href="#ä¿®æ”¹å®ä½“ç±»" class="headerlink" title="ä¿®æ”¹å®ä½“ç±»"></a>ä¿®æ”¹å®ä½“ç±»</h3><p>å°†å±æ€§è¿›è¡Œåˆ†ç»„</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Email</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">NotEmpty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">NotNull</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Size</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUser</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token comment">// ä¸»é”®</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"idä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">//ç”¨æˆ·å</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token comment">// å¯†ç </span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">"å¯†ç é•¿åº¦å¿…é¡»åœ¨&#123;min&#125; - &#123;max&#125;ä¹‹é—´"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>

    <span class="token comment">// é‚®ç®±åœ°å€</span>
    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±åœ°å€ä¸åˆæ³•"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>select<span class="token punctuation">.</span><span class="token keyword">class</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token comment">// ç”µè¯</span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸åˆæ³•"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>select<span class="token punctuation">.</span><span class="token keyword">class</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="ä¿®æ”¹æ§åˆ¶å™¨"><a href="#ä¿®æ”¹æ§åˆ¶å™¨" class="headerlink" title="ä¿®æ”¹æ§åˆ¶å™¨"></a>ä¿®æ”¹æ§åˆ¶å™¨</h3><p>æ·»åŠ æ“ä½œæ–¹æ³•ï¼Œå¹¶ä¸”æ–¹æ³•å½¢å‚ä¸ŠæŒ‡å®šéªŒè¯çš„åˆ†ç»„</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty<span class="token punctuation">.</span></span><span class="token class-name">SysUser</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>enitty<span class="token punctuation">.</span></span><span class="token class-name">ValidationInterface</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindingResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">FieldError</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Validated</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Collectors</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"sys/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUserController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">></span></span> USERS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ•°æ®åˆå§‹åŒ–</span>
    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SysUser</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"wen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"13666666666"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"example@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SysUser</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span><span class="token string">"13688888888"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"example1@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ ¹æ®æ‰‹æœºå·æˆ–é‚®ç®±æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
     * @param sysUser ç”¨æˆ·ä¿¡æ¯
     * @param result é”™è¯¯åé¦ˆ
     * @return ç”¨æˆ·ä¿¡æ¯
     */</span>
    <span class="token annotation punctuation">@GetMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">queryList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>select<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">SysUser</span> sysUser<span class="token punctuation">,</span><span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token function">getErrorMsg</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token class-name">String</span> phone <span class="token operator">=</span> sysUser<span class="token punctuation">.</span><span class="token function">getPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> email <span class="token operator">=</span> sysUser<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>phone <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> email <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>USERS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">></span></span> queryResult <span class="token operator">=</span> USERS<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>obj <span class="token operator">-></span> obj<span class="token punctuation">.</span><span class="token function">getPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span> <span class="token operator">||</span> obj<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>queryResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * è·å–è¡¨å•éªŒè¯é”™è¯¯msg
     * @param fieldError æŠ¥é”™å­—æ®µ
     * @return msg
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getErrorMsg</span><span class="token punctuation">(</span><span class="token class-name">FieldError</span> fieldError<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">String</span> field <span class="token operator">=</span> fieldError<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> rejectedValue <span class="token operator">=</span> fieldError<span class="token punctuation">.</span><span class="token function">getRejectedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">"["</span> <span class="token operator">+</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125;: å­—æ®µ==&#123;&#125;\tå€¼==&#123;&#125;"</span><span class="token punctuation">,</span>msg<span class="token punctuation">,</span>field<span class="token punctuation">,</span>rejectedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ–°å¢ç”¨æˆ·ä¿¡æ¯
     * @param sysUser ç”¨æˆ·ä¿¡æ¯
     * @param result é”™è¯¯åé¦ˆ
     * @return æˆåŠŸæ ‡è¯†
     */</span>
    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                                <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SysUser</span> sysUser<span class="token punctuation">,</span>
                                <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token function">getErrorMsg</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">Long</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span>USERS<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sysUser<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        USERS<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sysUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ–°å¢æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ ¹æ®idæ›´æ–°ç”¨æˆ·ä¿¡æ¯
     * @param id id
     * @param sysUser ç”¨æˆ·ä¿¡æ¯
     * @param result é”™è¯¯åé¦ˆ
     * @return æˆåŠŸæ ‡è¯†
     */</span>
    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">"&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">updateByid</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">,</span>
                                    <span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                                    <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SysUser</span> sysUser<span class="token punctuation">,</span>
                                    <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token function">getErrorMsg</span><span class="token punctuation">(</span>fieldError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>USERS<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>USERS<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                USERS<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>sysUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ›´æ–°æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ ¹æ®Idåˆ é™¤ç”¨æˆ·ä¿¡æ¯
     * @param id id
     * @return æˆåŠŸæ ‡è¯†
     */</span>
    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">"&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">deleteByid</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        USERS<span class="token punctuation">.</span><span class="token function">removeIf</span><span class="token punctuation">(</span>obj <span class="token operator">-></span> obj<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><strong>æŸ¥è¯¢</strong>ï¼šè¾“å…¥ä¸åˆæ³•æ‰‹æœºå·<br><img src="https://whh.plus/images/get.png" alt="get" loading="lazy"></p>
<p><strong>æ–°å¢</strong><br><img src="https://whh.plus/images/add.png" alt="add" loading="lazy"><br>å»æ‰é‚®ç®±<br><img src="https://whh.plus/images/add1.png" alt="add1" loading="lazy"></p>
<p><strong>æ›´æ–°</strong>ï¼šå»æ‰id<br><img src="https://whh.plus/images/put.png" alt="put" loading="lazy"></p>
<p><strong>åˆ é™¤</strong><br><img src="https://whh.plus/images/delete.png" alt="delete" loading="lazy"></p>
<h2 id="è‡ªå®šä¹‰éªŒè¯"><a href="#è‡ªå®šä¹‰éªŒè¯" class="headerlink" title="è‡ªå®šä¹‰éªŒè¯"></a>è‡ªå®šä¹‰éªŒè¯</h2><p>å¾ˆå¤šæ—¶å€™æ¡†æ¶æä¾›çš„åŠŸèƒ½å¹¶ä¸èƒ½æ»¡è¶³ä¸šåŠ¡åœºæ™¯ï¼Œéœ€è¦è‡ªå®šä¹‰ä¸€äº›éªŒè¯è§„åˆ™æ¥å®ŒæˆéªŒè¯ã€‚</p>
<h3 id="æ·»åŠ æ³¨è§£"><a href="#æ·»åŠ æ³¨è§£" class="headerlink" title="æ·»åŠ æ³¨è§£"></a>æ·»åŠ æ³¨è§£</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>annotation</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">PhoneValidator</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Constraint</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Payload</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Documented</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Retention</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Target</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">PhoneValidator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>METHOD<span class="token punctuation">,</span>FIELD<span class="token punctuation">,</span>ANNOTATION_TYPE<span class="token punctuation">,</span>CONSTRUCTOR<span class="token punctuation">,</span>PARAMETER<span class="token punctuation">,</span>TYPE_USE<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Phone</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// é»˜è®¤é”™è¯¯æ¶ˆæ¯</span>
    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„æ‰‹æœºå·"</span><span class="token punctuation">;</span>

    <span class="token comment">// åˆ†ç»„</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// è½½è· å°†æŸäº› å…ƒæ•°æ®ä¿¡æ¯ä¸ç»™å®šçš„æ³¨è§£å£°æ˜ç›¸å…³è”çš„æ–¹æ³•</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">//æŒ‡å®šå¤šä¸ªæ—¶ä½¿ç”¨</span>
    <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>FIELD<span class="token punctuation">,</span>METHOD<span class="token punctuation">,</span>PARAMETER<span class="token punctuation">,</span>ANNOTATION_TYPE<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RUNTIME<span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Documented</span>
    <span class="token annotation punctuation">@interface</span> <span class="token class-name">List</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Phone</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<ul>
<li>@Documentedï¼šæ˜¯å¦å°†æ³¨è§£ä¿¡æ¯æ·»åŠ åœ¨Javaæ–‡æ¡£ä¸­</li>
<li>@Retentionï¼šå®šä¹‰è¯¥æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ.(SOURCE:åœ¨ç¼–è¯‘é˜¶æ®µä¸¢å¼ƒã€‚è¿™äº›æ³¨è§£åœ¨ç¼–è¯‘ç»“æŸä¹‹åå°±ä¸å†æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚@Overrideï¼Œ@SuppressWarnings;CLASSï¼šåœ¨ç±»åŠ è½½é˜¶æ®µä¸¢å¼ƒï¼Œåœ¨å­—èŠ‚ç æ–‡ä»¶çš„å¤„ç†ä¸­æœ‰ç”¨ã€‚æ³¨è§£é»˜è®¤ä½¿ç”¨è¿™ç§æ–¹å¼ï¼›RUNTIMEï¼šå§‹ç»ˆä¸ä¼šä¸¢å¼ƒï¼Œè¿è¡ŒæœŸä¹Ÿä¿ç•™è¯¥æ³¨è§£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è¯»å–è¯¥æ³¨è§£ä¿¡æ¯ï¼Œè‡ªå®šä¹‰æ³¨è§£é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼)</li>
<li>@Targetï¼šæ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ï¼Œå¦‚æœä¸æ˜ç¡®æŒ‡å‡ºï¼Œè¯¥æ³¨è§£å¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ã€‚å±æ€§çš„æ³¨è§£æ˜¯å…¼å®¹çš„ã€‚(TYPEï¼šç”¨äºæè¿°ç±»ã€æ¥å£æˆ–enumå£°æ˜ï¼›FIELDï¼šç”¨äºæè¿°å®ä¾‹å˜é‡ï¼›METHODï¼šç”¨äºæè¿°æ–¹æ³•ï¼›PARAMETERï¼šå‚æ•°ï¼›CONSTRUCTORï¼šæ„é€ æ–¹æ³•ï¼›LOCAL_VARIABLEï¼šå±€éƒ¨å˜é‡ï¼›ANNOTATION_TYPEï¼šå¦ä¸€ä¸ªæ³¨é‡Šï¼›PACKAGEï¼šç”¨äºè®°å½•javaæ–‡ä»¶çš„packageä¿¡æ¯)</li>
<li>@Constraintï¼šå¤„ç†æ³¨è§£çš„é€»è¾‘</li>
</ul>
<h3 id="ç¼–å†™éªŒè¯é€»è¾‘"><a href="#ç¼–å†™éªŒè¯é€»è¾‘" class="headerlink" title="ç¼–å†™éªŒè¯é€»è¾‘"></a>ç¼–å†™éªŒè¯é€»è¾‘</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>validation</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Phone</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidatorContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span></span><span class="token class-name">Pattern</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * æ‰‹æœºå·æ ¡éªŒå™¨
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PhoneValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**
     * æ‰‹æœºå·æ­£åˆ™è¡¨è¾¾å¼
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> REGEXP_PHONE <span class="token operator">=</span> <span class="token string">"^1[3456789]\\d&#123;9&#125;$"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> constraintValidatorContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>REGEXP_PHONE<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="ä¿®æ”¹å®ä½“"><a href="#ä¿®æ”¹å®ä½“" class="headerlink" title="ä¿®æ”¹å®ä½“"></a>ä¿®æ”¹å®ä½“</h3><p>ç»™phoneæ·»åŠ æ³¨è§£@Phone</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Phone</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>update<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                <span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>select<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span></code></pre>

<h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>è¾“å…¥é”™è¯¯çš„æ‰‹æœºå·æµ‹è¯•<br><img src="https://whh.plus/images/phone.png" alt="phone" loading="lazy"></p>
<h3 id="Pattern"><a href="#Pattern" class="headerlink" title="@Pattern"></a>@Pattern</h3><p>validationä¹Ÿæä¾›äº†åŸºäºæ­£åˆ™åŒ¹é…çš„æ³¨è§£@Pattern</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸åˆæ³•"</span><span class="token punctuation">,</span>regexp <span class="token operator">=</span> <span class="token string">"^1[3456789]\\d&#123;9&#125;"</span>$<span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ValidationInterface</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span></code></pre>

<h2 id="è°ƒç”¨è¿‡ç¨‹éªŒè¯"><a href="#è°ƒç”¨è¿‡ç¨‹éªŒè¯" class="headerlink" title="è°ƒç”¨è¿‡ç¨‹éªŒè¯"></a>è°ƒç”¨è¿‡ç¨‹éªŒè¯</h2><p>æœ‰æ—¶å€™åœ¨å‚æ•°ä¼ è¾“è¿‡ç¨‹ä¸­éœ€è¦å¯¹ä¼ å…¥çš„å¯¹è±¡åšå‚æ•°éªŒè¯ï¼Œä½†æ˜¯ä¸Šé¢ä»‹ç»çš„æ˜¯å¯¹å‚æ•°ç»‘å®šæ—¶çš„éªŒè¯ã€‚</p>
<h3 id="ä½¿ç”¨-spring-bean"><a href="#ä½¿ç”¨-spring-bean" class="headerlink" title="ä½¿ç”¨ spring bean"></a>ä½¿ç”¨ spring bean</h3><ul>
<li>æ³¨å…¥validator<br>bean validatoræ˜¯åœ¨configä¸­å®šä¹‰çš„beanï¼Œå¦‚æœä½¿ç”¨spring booté»˜è®¤é…ç½®ValidationAutoConfiguration::defaultValidator(),ç›´æ¥æ³¨å…¥bean<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"validator"</span><span class="token punctuation">)</span>
<span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span>Validator</span> validator<span class="token punctuation">;</span></code></pre></li>
<li></li>
</ul>
<h2 id="æ–¹æ³•å‚æ•°éªŒè¯"><a href="#æ–¹æ³•å‚æ•°éªŒè¯" class="headerlink" title="æ–¹æ³•å‚æ•°éªŒè¯"></a>æ–¹æ³•å‚æ•°éªŒè¯</h2><ul>
<li>ä¿®æ”¹æ§åˆ¶å™¨<br>ç›´æ¥åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@Validatedï¼Œå¹¶åœ¨æ–¹æ³•ä¸Šç›´æ¥è¿›è¡ŒéªŒè¯<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Validated</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"sys/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUserController</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> çœç•¥ä»£ç 
    <span class="token comment">/**
     * æ ¹æ®æ‰‹æœºå·å’Œé‚®ç®±æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
     * @param phone æ‰‹æœºå·
     * @return ç”¨æˆ·list
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"selectByPhone"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">queryByPhone</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> phone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">></span></span> queryResult <span class="token operator">=</span> USERS<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>obj <span class="token operator">-></span> obj<span class="token punctuation">.</span><span class="token function">getPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>queryResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre></li>
<li>æµ‹è¯•<br><img src="https://whh.plus/images/get1.png" alt="get" loading="lazy"></li>
</ul>
<h2 id="ç»Ÿä¸€å¼‚å¸¸å¤„ç†"><a href="#ç»Ÿä¸€å¼‚å¸¸å¤„ç†" class="headerlink" title="ç»Ÿä¸€å¼‚å¸¸å¤„ç†"></a>ç»Ÿä¸€å¼‚å¸¸å¤„ç†</h2><p>ä¸Šé¢å‚æ•°éªŒè¯æ—¶ï¼ŒéªŒè¯çš„é”™è¯¯ä¿¡æ¯æ˜¯é€šè¿‡<code>BindingResult result</code>å‚æ•°è¿›è¡Œæ¥æ”¶çš„ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚ç”šè‡³æ˜¯ç›´æ¥å°†å¼‚å¸¸å †æ ˆä¿¡æ¯è¿”å›ç»™å‰ç«¯ï¼Œä¸å¤ªå‹å¥½ï¼Œæœ‰çš„æ—¶å€™éœ€è¦ä¸»åŠ¨æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œæ¯”å¦‚ç”¨æˆ·ä¸èƒ½ç›´æ¥åˆ é™¤å·²ç»‘å®šç”¨æˆ·çš„è§’è‰²ã€‚</p>
<h3 id="åˆ›å»ºä¸šåŠ¡å¼‚å¸¸ç±»"><a href="#åˆ›å»ºä¸šåŠ¡å¼‚å¸¸ç±»" class="headerlink" title="åˆ›å»ºä¸šåŠ¡å¼‚å¸¸ç±»"></a>åˆ›å»ºä¸šåŠ¡å¼‚å¸¸ç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸šåŠ¡å¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BusinessException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨"><a href="#åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨"></a>åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whh<span class="token punctuation">.</span>valid<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindingResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">FieldError</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span><span class="token class-name">HttpRequestMethodNotSupportedException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintViolation</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintViolationException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ValidationException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * å…¨å±€å¼‚å¸¸å¤„ç†å™¨
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**
     * å‚æ•°ç»‘å®šå¼‚å¸¸ç±»ï¼Œç”¨äºè¡¨å•éªŒè¯æ—¶æŠ›å‡ºå¼‚å¸¸å¤„ç†
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">BindException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">validatedBindException</span><span class="token punctuation">(</span><span class="token class-name">BindException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BindingResult</span> bindingResult <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">"["</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * ç”¨äºæ–¹æ³•å½¢å‚ä¸­å‚æ•°æ ¡éªŒæ—¶æŠ›å‡ºçš„å¼‚å¸¸å¤„ç†
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">ValidationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> errorInfo <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">ConstraintViolationException</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ConstraintViolationException</span> exs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span><span class="token punctuation">)</span> e<span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConstraintViolation</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> violations <span class="token operator">=</span> exs<span class="token punctuation">.</span><span class="token function">getConstraintViolations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ConstraintViolation</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> item <span class="token operator">:</span> violations<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                errorInfo <span class="token operator">=</span> errorInfo <span class="token operator">+</span> <span class="token string">"["</span> <span class="token operator">+</span> item<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>errorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * è¯·æ±‚æ–¹å¼ä¸æ”¯æŒ
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token class-name">HttpRequestMethodNotSupportedException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">HttpRequestMethodNotSupportedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"ä¸æ”¯æŒ"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"è¯·æ±‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * æ‹¦æˆªæœªçŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">notFount</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œæ—¶å¼‚å¸¸"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œæ—¶å¼‚å¸¸"</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * ç³»ç»Ÿå¼‚å¸¸
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * ä¸šåŠ¡å¼‚å¸¸
     * @param request
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">BusinessException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">bussinessException</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">BusinessException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<ul>
<li>@Slf4jæ³¨è§£ï¼šç”¨ä½œæ—¥å¿—è¾“å‡ºçš„ï¼Œä¸€èˆ¬ä¼šåœ¨é¡¹ç›®æ¯ä¸ªç±»çš„å¼€å¤´åŠ å…¥è¯¥æ³¨è§£ï¼Œå¦‚æœä¸å†™ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¹¶ä¸”æƒ³ç”¨log</li>
<li>@RestControllerAdviceï¼šå¯¹Controllerå¢å¼ºï¼Œæ•è·å…¨å±€Spring MVCæŠ›å‡ºçš„å¼‚å¸¸ã€‚</li>
<li>@ExceptionHandler(BindException.class)ï¼šç”¨æ¥æ•è·æŒ‡å®šçš„å¼‚å¸¸</li>
</ul>
<h3 id="ä¿®æ”¹æ§åˆ¶å™¨-1"><a href="#ä¿®æ”¹æ§åˆ¶å™¨-1" class="headerlink" title="ä¿®æ”¹æ§åˆ¶å™¨"></a>ä¿®æ”¹æ§åˆ¶å™¨</h3><p>åˆ é™¤æ–¹æ³•ä¸­çš„BindingResult resultå‚æ•°ï¼Œå°†é”™è¯¯ç›´æ¥æŠ›ç»™ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»å»è§£å†³å³å¯</p>
<h3 id="æµ‹è¯•-3"><a href="#æµ‹è¯•-3" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><img src="https://whh.plus/images/testException.png" alt="test" loading="lazy"></p>
<h2 id="è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº"><a href="#è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº" class="headerlink" title="è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº"></a>è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº</h2><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶-ValidatorConfig"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶-ValidatorConfig" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶(ValidatorConfig)"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶(ValidatorConfig)</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/**
     * å®ä½“ç±»å­—æ®µæ ¡éªŒå›½é™…åŒ–å¼•å…¥
     * */</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Validator</span> <span class="token function">validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token comment">//        ValidatorFactory validatorFactory = Validation.byProvider(HibernateValidator.class)</span>
<span class="token comment">//                .configure()</span>
<span class="token comment">//                .addProperty("hibernate.validator.fail_fast","true")</span>
<span class="token comment">//                .buildValidatorFactory();</span>
        <span class="token class-name">LocalValidatorFactoryBean</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LocalValidatorFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®messagesèµ„æºä¿¡æ¯</span>
        <span class="token class-name">ReloadableResourceBundleMessageSource</span> messageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReloadableResourceBundleMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¤šä¸ªç”¨é€—å·åˆ†å‰²</span>
        messageSource<span class="token punctuation">.</span><span class="token function">setBasenames</span><span class="token punctuation">(</span><span class="token string">"classpath:/messages/validation/messages"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®å­—ç¬¦é›†ç¼–ç </span>
        messageSource<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        validator<span class="token punctuation">.</span><span class="token function">setValidationMessageSource</span><span class="token punctuation">(</span>messageSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®éªŒè¯ç›¸å…³å‚æ•°</span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¿«é€Ÿå¤±è´¥ï¼Œæœ‰é”™å³è¿”å›</span>
        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"hibernate.validator.fail_fast"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        validator<span class="token punctuation">.</span><span class="token function">setValidationProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        return validatorFactory.getValidator();</span>
        <span class="token keyword">return</span> validator<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span></code></pre>
<h3 id="æ·»åŠ ä¿¡æ¯æºæ–‡ä»¶"><a href="#æ·»åŠ ä¿¡æ¯æºæ–‡ä»¶" class="headerlink" title="æ·»åŠ ä¿¡æ¯æºæ–‡ä»¶"></a>æ·»åŠ ä¿¡æ¯æºæ–‡ä»¶</h3><pre class="language-bash" data-language="bash"><code class="language-bash">â”œâ”€â”€â”€resources
    â””â”€â”€ messages
        â””â”€â”€ validation
            â””â”€â”€ messages.properties</code></pre>

<pre class="language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># messages.properties</span>
<span class="token attr-name">name.not.empty</span><span class="token punctuation">=</span><span class="token attr-value">ç”¨æˆ·åä¸èƒ½ä¸ºç©º</span>
<span class="token attr-name">email.not.valid</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;validatedValue&#125;æ˜¯é‚®ç®±åœ°å€ï¼Ÿ</span>
<span class="token attr-name">email.not.empty</span><span class="token punctuation">=</span><span class="token attr-value">é‚®ç®±ä¸èƒ½ä¸ºç©º</span>
<span class="token attr-name">phone.not.valid</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;validatedValue&#125;æ˜¯æ‰‹æœºå·ï¼Ÿ</span>
<span class="token attr-name">phone.not.empty</span><span class="token punctuation">=</span><span class="token attr-value">æ‰‹æœºå·ä¸èƒ½ä¸ºç©º</span>
<span class="token attr-name">password.size.valid</span><span class="token punctuation">=</span><span class="token attr-value">å¯†ç é•¿åº¦å¿…é¡»åœ¨&#123;min&#125;-&#123;max&#125;ä¹‹é—´</span>
<span class="token attr-name">id.not.empty</span><span class="token punctuation">=</span><span class="token attr-value">ä¸»é”®ä¸èƒ½ä¸ºç©º</span></code></pre>

<h3 id="ä¿®æ”¹å®ä½“ç±»-1"><a href="#ä¿®æ”¹å®ä½“ç±»-1" class="headerlink" title="ä¿®æ”¹å®ä½“ç±»"></a>ä¿®æ”¹å®ä½“ç±»</h3><pre class="language-java" data-language="java"><code class="language-java">message <span class="token operator">=</span> <span class="token string">"&#123;name.not.empty&#125;"</span>
message <span class="token operator">=</span> <span class="token string">"&#123;password.size.valid&#125;"</span>
message <span class="token operator">=</span> <span class="token string">"&#123;email.not.valid&#125;"</span>
message <span class="token operator">=</span> <span class="token string">"&#123;phone.not.valid&#125;"</span></code></pre>

<h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><table>
<thead>
<tr>
<th align="center">æ³¨è§£</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">@Null</td>
<td align="center">é™åˆ¶åªèƒ½ä¸ºnull</td>
</tr>
<tr>
<td align="center">@NotNull</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ä¸ºnull</td>
</tr>
<tr>
<td align="center">@AssertFalse</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºfalse</td>
</tr>
<tr>
<td align="center">@AssertTrue</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºtrue</td>
</tr>
<tr>
<td align="center">@DecimalMax(value)</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºæŒ‡å®šå€¼çš„æ•°å­—</td>
</tr>
<tr>
<td align="center">@DecimalMin(value)</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºæŒ‡å®šå€¼çš„æ•°å­—</td>
</tr>
<tr>
<td align="center">@Digits(integer,fraction)</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªå°æ•°ï¼Œä¸”æ•´æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡integerï¼Œå°æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡fraction</td>
</tr>
<tr>
<td align="center">@Future</td>
<td align="center">é™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ</td>
</tr>
<tr>
<td align="center">@Max(value)</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºæŒ‡å®šå€¼çš„æ•°å­—</td>
</tr>
<tr>
<td align="center">@Min(value)</td>
<td align="center">é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºæŒ‡å®šå€¼çš„æ•°å­—</td>
</tr>
<tr>
<td align="center">@Past</td>
<td align="center">é™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ</td>
</tr>
<tr>
<td align="center">@Pattern(value)</td>
<td align="center">é™åˆ¶å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
<tr>
<td align="center">@Size(max,min)</td>
<td align="center">é™åˆ¶å­—ç¬¦é•¿åº¦å¿…é¡»åœ¨minåˆ°maxä¹‹é—´</td>
</tr>
<tr>
<td align="center">@Past</td>
<td align="center">éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ï¼ˆæ—¥æœŸç±»å‹ï¼‰æ¯”å½“å‰æ—¶é—´æ—©</td>
</tr>
<tr>
<td align="center">@NotEmpty</td>
<td align="center">éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºnullä¸”ä¸ä¸ºç©ºï¼ˆå­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º0ã€é›†åˆå¤§å°ä¸ä¸º0ï¼‰</td>
</tr>
<tr>
<td align="center">@NotBlank</td>
<td align="center">éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºç©ºï¼ˆä¸ä¸ºnullã€å»é™¤é¦–ä½ç©ºæ ¼åé•¿åº¦ä¸º0ï¼‰ï¼Œä¸åŒäº@NotEmptyï¼Œ@NotBlank</td>
</tr>
<tr>
<td align="center">@Email</td>
<td align="center">éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯Emailï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å’ŒflagæŒ‡å®šè‡ªå®šä¹‰çš„emailæ ¼å¼</td>
</tr>
</tbody></table>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://www.toutiao.com/i6994693398586393096/">å¼€æ’¸ï¼SpringBoot-è¡¨å•éªŒè¯-ç»Ÿä¸€å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/f641385712/article/details/97402946">Springæ–¹æ³•çº§åˆ«æ•°æ®æ ¡éªŒ</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c1ee7e4247bf">@Dataæ³¨è§£ ä¸ lombok</a><br><a target="_blank" rel="noopener" href="https://www.hangge.com/blog/cache/detail_2493.html">SpringBoot - Lombokä½¿ç”¨è¯¦è§£3ï¼ˆ@NoArgsConstructorã€@AllArgsConstructorã€@RequiredArgsConstructorï¼‰</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/lwg_1540652358/article/details/84193759">@Constraintæ³¨è§£é…åˆè‡ªå®šä¹‰éªŒè¯ç±»å‹æ³¨è§£çš„å¼€å‘</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/47aeeba6414c">Spring Boot @RestControllerAdvice ç»Ÿä¸€å¼‚å¸¸å¤„ç†</a></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"></div><div style="display:inline-block"></div><div style="display:inline-block"></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å…ˆé€ƒè·‘å†è¯´</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://wentianhao.github.io/2021/08/20/validation/" title="SpringBoot-è¡¨å•éªŒè¯-ç»Ÿä¸€å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰éªŒè¯ä¿¡æ¯æº">https://wentianhao.github.io/2021/08/20/validation/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/08/25/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%AE%9E%E8%B7%B5/" rel="prev" title="çº¿ç¨‹æ± å®è·µ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">çº¿ç¨‹æ± å®è·µ</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/08/18/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" rel="next" title="çº¿ç¨‹æ± "><span class="post-nav-text">çº¿ç¨‹æ± </span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br></div><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#valine-container" onclick="showComment(this.dataset.target)">valine</a><style>.utterances {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target=".utterances" onclick="showComment(this.dataset.target)">utterances</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"lKhR0buRT7OeiwUq9ECRwPba-MdYXbMMI","appKey":"5cz28s0hMEfyou89engEFMmS","placeholder":"Just go go","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick","mail","link"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/2021/08/20/validation/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> å…ˆé€ƒè·‘å†è¯´</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.1</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-01-05T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script>const date = new Date();
const today = (date.getMonth() + 1) + "-" + date.getDate()
const mourn_days = ["4-4","9-18"]
if (mourn_days.includes(today)) {
  document.documentElement.style.filter = "grayscale(1)";
}</script></div></body></html>