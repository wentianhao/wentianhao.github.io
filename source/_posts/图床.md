---
title: 服务器自建图床
katex: false
tags: 图床
categories: docker
abbrlink: 1349
date: 2021-07-05 18:53:03
---


最近着手搭建一个自用的图床，之前以有博客，图片一般存在博客的某个文件夹下，但是每次写博客的时候都要先将图片上传到服务器然后配图不能本地显示略嫌麻烦，因此准备在自己网站上搭建图床，使用docker，结合开源项目Lychee

以下操作基于：Ubuntu 18.04
<!-- more -->
## 安装docker： 
```bash
sudo apt-get update  # 更新apt源
# 安装apt依赖包，用于通过https来获取仓库
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
# 添加Docker的官方GPG密钥
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
# 设置稳定版仓库
sudo add-apt-repository \
    "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
    $(lsb_release -cs) \
    stable"
# 安装Docker-ce
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io
# 测试运行
sudo docker run hello-world
# 添加当前用户到docker用户组
# 列出自己的用户组，确认自己在不在 docker 组中
groups
# 没有则新增docker组
sudo groupadd docker
# 把当前用户加入到docker组中
sudo gpasswd -a ${USER} docker
# 重启docker服务
sudo service docker restart
```

## 部署Lychee
启动镜像,是端口映射，5120->80，访问5120端口映射到docker容器的80端口
```bash
docker image pull kdelfour/lychee-docker
docker image ls
docker run -it -d -p 5120:80 kdelfour/lychee-docker
docker container ls #查看正在运行的容器
```

## 搭建成功
访问http://ip:5120，新建用户密码，即可上传成功

图片存于服务器的具体地址
```bash
docker container ls #显示容器的container id
docker container exec -it [container-id] /bin/bash # 进入容器
ls
cd updates # 此目录的big目录下即为图片存放位置
```

## 卸载方式
```bash
docker container stop [container-id] # 停止运行容器
docker container rm [container-id] # 删除容器
docker image rmi [image-id] # 删除镜像
```

参考文章
[1.在Ubuntu 18.04安装Docker](https://blog.csdn.net/b9567/article/details/105027440/)
[2.Docker容器使用](https://www.runoob.com/docker/docker-container-usage.html)
[3.教你如何搭建自己的图床](https://www.cnblogs.com/lwp-nicol/p/14329710.html)

感谢以上参考文章！